export type Language = 'en' | 'fr';

export const translations = {
  en: {
    appName: 'KingstonAccess',
    appSubtitle: 'Accessible parking finder',
    chat: 'Chat',
    you: 'You',
    assistant: 'Assistant',
    typeDestination: 'Type a destination (e.g. {example}) and I\'ll show matches to pick from.',
    matches: 'Matches',
    matchesFor: 'Matches for "{query}"',
    onlyAccessibleSpaces: 'Only show lots with accessible spaces',
    parkingLots: 'Parking lots',
    results: 'Results',
    language: 'Language',
    features: 'Features',
    nearbyAccessibilityFeatures: 'Nearby accessibility features (within {radius}m)',
    total: 'Total',
    reLocate: 'Re-locate',
    clearRoute: 'Clear route',
    resetChat: 'Reset chat',
    skipToMap: 'Skip to map',
    skipToResults: 'Skip to results',
    map: 'Map',
    interactiveMap: 'Interactive map',
    lists: 'Lists',
    navigation: 'Navigation',
    distance: 'Distance',
    withTraffic: 'With traffic',
    base: 'Base',
    delay: 'Delay',
    time: 'Time',
    leg: 'Leg',
    step: 'Step',
    from: 'From',
    to: 'To',
    viewOnMap: 'View on map',
    navigate: 'Navigate',
    navigateViaAccessible: 'Navigate (via accessible parking)',
    selected: 'Selected',
    destination: 'Destination',
    nearestAccessibleOptions: 'Nearest accessible options (Top 5)',
    loadingNearestOptions: 'Loading nearest options…',
    noAccessibleParkingFound: 'No accessible parking lots found.',
    accessibleSpaces: 'Accessible spaces',
    owner: 'Owner',
    capacity: 'Capacity',
    type: 'Type',
    useAsWaypoint: 'Use as waypoint',
    noAccessibleMatch: 'No accessible parking lots match.',
    tryIncreasingDistance: 'Try increasing distance or clearing search.',
    foundMatchingLots: 'Found {count} matching parking lot{plural}.',
    viewParkingLots: 'View parking lots',
    noParkingLotsMatch: 'No parking lots match your search.',
    dataSource: 'Data source: Kingston Open Data',
    privacyNotice: 'Privacy & MFIPPA Compliance',
    privacyText: 'This application processes location data locally in your browser. No personal information is transmitted to external servers except for map services (Google Maps) and AI processing (Backboard AI). Location data is not stored or logged. Chat messages are processed by Backboard AI for destination parsing only. This application complies with the Municipal Freedom of Information and Protection of Privacy Act (MFIPPA).',
    privacyContact: 'For privacy inquiries, contact the City of Kingston.',
    selectedSeeResults: 'Selected: {label}. See nearest accessible parking in Results.',
    foundMatches: 'I found {count} matches for "{query}". Choose one below:',
    destinationMatches: 'Destination matches',
    tellMeDestination: 'Tell me a destination (e.g., "{example}") and optionally a max walk distance (e.g., "150m").',
    locationUpdated: 'Location updated. Enter a destination to see nearby accessible parking.',
    couldNotAccessLocation: 'Could not access location. You can still enter a destination and browse lots.',
    couldNotLoadData: 'Could not load parking lot data.',
    mapStillLoading: 'Map is still loading. Try again in a moment.',
    couldNotComputeRoute: 'Could not compute a route. Try again.',
    waypoint: 'Waypoint',
    noteDataset: 'Note: This dataset contains public parking lots and may not include private lots (e.g., at large retail stores).',
    typeDestinationOrRelocate: 'Type a destination in chat (e.g. {example}) or click {relocate} to see nearby accessible parking.',
    unnamedLot: 'Unnamed lot',
    downtown: 'Downtown',
    locationPermissionDenied: 'Location permission denied. Allow location access in your browser settings and try again.',
    locationUnavailable: 'Location unavailable. Check your device location services and try again.',
    locationTimeout: 'Location request timed out. Try again, or move closer to a window for better GPS signal.',
    keyboardShortcuts: 'Keyboard Shortcuts',
    shortcutFocusChat: 'Focus chat input',
    shortcutToggleLeftPanel: 'Toggle left panel',
    shortcutToggleRightPanel: 'Toggle right panel',
    shortcutRelocate: 'Re-locate',
    pressForShortcuts: 'Press ? for keyboard shortcuts',
    showKeyboardShortcuts: 'Show keyboard shortcuts',
    help: 'Help',
    sendingMessage: 'Sending message…',
    processing: 'Processing…',
    loadingMap: 'Loading map…',
    typeDestinationPlaceholder: 'Type a destination (e.g. Metro)',
    chatInputLabel: 'Chat input',
    sendMessage: 'Send message',
    relocate: 'Relocate',
    chatReset: 'Chat reset.',
    tipKeyboardNavigation: 'Tip: Use keyboard Tab/Shift+Tab to navigate controls and results.',
    showLeftPanel: 'Show left panel',
    hideLeftPanel: 'Hide left panel',
    showRightPanel: 'Show right panel',
    hideRightPanel: 'Hide right panel',
    close: 'Close',
    navigationDirections: 'Navigation directions',
    transit: 'Transit',
    toward: 'toward',
    stops: 'Stops',
    listTabs: 'List tabs'
  },
  fr: {
    appName: 'KingstonAccess',
    appSubtitle: 'Localisateur de stationnement accessible',
    chat: 'Chat',
    you: 'Vous',
    assistant: 'Assistant',
    typeDestination: 'Tapez une destination (p. ex. {example}) et je vous montrerai des correspondances à choisir.',
    matches: 'Correspondances',
    matchesFor: 'Correspondances pour "{query}"',
    onlyAccessibleSpaces: 'Afficher uniquement les lots avec espaces accessibles',
    parkingLots: 'Stationnements',
    results: 'Résultats',
    language: 'Langue',
    features: 'Fonctionnalités',
    nearbyAccessibilityFeatures: 'Fonctionnalités d\'accessibilité à proximité (dans un rayon de {radius}m)',
    total: 'Total',
    reLocate: 'Relocaliser',
    clearRoute: 'Effacer l\'itinéraire',
    resetChat: 'Réinitialiser le chat',
    skipToMap: 'Aller à la carte',
    skipToResults: 'Aller aux résultats',
    map: 'Carte',
    interactiveMap: 'Carte interactive',
    lists: 'Listes',
    navigation: 'Navigation',
    distance: 'Distance',
    withTraffic: 'Avec circulation',
    base: 'Base',
    delay: 'Retard',
    time: 'Temps',
    leg: 'Étape',
    step: 'Étape',
    from: 'De',
    to: 'À',
    viewOnMap: 'Voir sur la carte',
    navigate: 'Naviguer',
    navigateViaAccessible: 'Naviguer (via stationnement accessible)',
    selected: 'Sélectionné',
    destination: 'Destination',
    nearestAccessibleOptions: 'Options accessibles les plus proches (Top 5)',
    loadingNearestOptions: 'Chargement des options les plus proches…',
    noAccessibleParkingFound: 'Aucun stationnement accessible trouvé.',
    accessibleSpaces: 'Espaces accessibles',
    owner: 'Propriétaire',
    capacity: 'Capacité',
    type: 'Type',
    useAsWaypoint: 'Utiliser comme point de passage',
    noAccessibleMatch: 'Aucun stationnement accessible ne correspond.',
    tryIncreasingDistance: 'Essayez d\'augmenter la distance ou d\'effacer la recherche.',
    foundMatchingLots: '{count} stationnement{plural} correspondant{plural} trouvé{plural}.',
    viewParkingLots: 'Voir les stationnements',
    noParkingLotsMatch: 'Aucun stationnement ne correspond à votre recherche.',
    dataSource: 'Source de données : Données ouvertes de Kingston',
    privacyNotice: 'Confidentialité et conformité MFIPPA',
    privacyText: 'Cette application traite les données de localisation localement dans votre navigateur. Aucune information personnelle n\'est transmise à des serveurs externes, sauf pour les services de cartes (Google Maps) et le traitement IA (Backboard AI). Les données de localisation ne sont pas stockées ou enregistrées. Les messages de chat sont traités par Backboard AI uniquement pour l\'analyse des destinations. Cette application est conforme à la Loi sur l\'accès à l\'information municipale et la protection de la vie privée (MFIPPA).',
    privacyContact: 'Pour les questions de confidentialité, contactez la Ville de Kingston.',
    selectedSeeResults: 'Sélectionné : {label}. Voir les stationnements accessibles les plus proches dans Résultats.',
    foundMatches: 'J\'ai trouvé {count} correspondances pour "{query}". Choisissez-en une ci-dessous :',
    destinationMatches: 'Correspondances de destination',
    tellMeDestination: 'Indiquez-moi une destination (p. ex., "{example}") et éventuellement une distance de marche maximale (p. ex., "150m").',
    locationUpdated: 'Localisation mise à jour. Entrez une destination pour voir les stationnements accessibles à proximité.',
    couldNotAccessLocation: 'Impossible d\'accéder à la localisation. Vous pouvez toujours entrer une destination et parcourir les lots.',
    couldNotLoadData: 'Impossible de charger les données de stationnement.',
    mapStillLoading: 'La carte est toujours en cours de chargement. Réessayez dans un instant.',
    couldNotComputeRoute: 'Impossible de calculer un itinéraire. Réessayez.',
    waypoint: 'Point de passage',
    noteDataset: 'Remarque : Ce jeu de données contient des stationnements publics et peut ne pas inclure les lots privés (p. ex., dans les grands magasins de détail).',
    typeDestinationOrRelocate: 'Tapez une destination dans le chat (p. ex. {example}) ou cliquez sur {relocate} pour voir les stationnements accessibles à proximité.',
    unnamedLot: 'Lot sans nom',
    downtown: 'Centre-ville',
    locationPermissionDenied: 'Autorisation de localisation refusée. Autorisez l\'accès à la localisation dans les paramètres de votre navigateur et réessayez.',
    locationUnavailable: 'Localisation indisponible. Vérifiez les services de localisation de votre appareil et réessayez.',
    locationTimeout: 'La demande de localisation a expiré. Réessayez ou rapprochez-vous d\'une fenêtre pour un meilleur signal GPS.',
    keyboardShortcuts: 'Raccourcis clavier',
    shortcutFocusChat: 'Focus sur la saisie du chat',
    shortcutToggleLeftPanel: 'Basculer le panneau gauche',
    shortcutToggleRightPanel: 'Basculer le panneau droit',
    shortcutRelocate: 'Relocaliser',
    pressForShortcuts: 'Appuyez sur ? pour les raccourcis clavier',
    showKeyboardShortcuts: 'Afficher les raccourcis clavier',
    help: 'Aide',
    sendingMessage: 'Envoi du message…',
    processing: 'Traitement…',
    loadingMap: 'Chargement de la carte…',
    typeDestinationPlaceholder: 'Tapez une destination (p. ex. Metro)',
    chatInputLabel: 'Saisie du chat',
    sendMessage: 'Envoyer le message',
    relocate: 'Relocaliser',
    chatReset: 'Chat réinitialisé.',
    tipKeyboardNavigation: 'Astuce : Utilisez Tab/Maj+Tab pour naviguer dans les contrôles et les résultats.',
    showLeftPanel: 'Afficher le panneau gauche',
    hideLeftPanel: 'Masquer le panneau gauche',
    showRightPanel: 'Afficher le panneau droit',
    hideRightPanel: 'Masquer le panneau droit',
    close: 'Fermer',
    navigationDirections: 'Directions de navigation',
    transit: 'Transit',
    toward: 'vers',
    stops: 'Arrêts',
    listTabs: 'Onglets de liste'
  }
};

let currentLanguage: Language = 'en';

export function setLanguage(lang: Language): void {
  currentLanguage = lang;
  if (typeof window !== 'undefined') {
    localStorage.setItem('kingstonaccess-language', lang);
  }
}

export function getLanguage(): Language {
  if (typeof window !== 'undefined') {
    const stored = localStorage.getItem('kingstonaccess-language');
    if (stored === 'en' || stored === 'fr') {
      return stored;
    }
  }
  return 'en';
}

export function t(key: keyof typeof translations.en, params?: Record<string, string | number>): string {
  const text = translations[currentLanguage][key] ?? translations.en[key] ?? String(key);
  if (!params) return text;
  let result = text;
  for (const [k, v] of Object.entries(params)) {
    result = result.replace(new RegExp(`\\{${k}\\}`, 'g'), String(v));
  }
  return result;
}
